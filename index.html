<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SDJ Licensing System</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
<style>
:root {
  --bg:#0b0f1a;
  --card:#121a2a;
  --accent:#ff8a00;
  --accent-light:#ffc06b;
  --text:#eaeaea;
  --text-muted:#99a6bd;
  --glass: rgba(255,255,255,0.03);
  --shadow: rgba(0,0,0,0.5);
  --success:#7ef29b;
  --danger:#ff6b6b;
}
* {box-sizing:border-box;}
body {
  margin:0;
  font-family:'Inter',sans-serif;
  background:linear-gradient(135deg,#0b0f1a 0%,#1a2238 100%);
  color:var(--text);
}
header {
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:20px 40px;
  background:var(--card);
  box-shadow:0 4px 12px var(--shadow);
  border-bottom:1px solid rgba(255,255,255,0.05);
}
header h1 {
  margin:0;
  font-size:24px;
  font-weight:600;
  display:flex;
  align-items:center;
  gap:10px;
}
header h1 img {height:40px;border-radius:6px;}
header .lead {font-size:13px;color:var(--text-muted);}
.wrap {
  display:flex;
  justify-content:center;
  gap:20px;
  padding:20px;
  flex-wrap:wrap;
}
.card {
  background:var(--card);
  border-radius:12px;
  padding:20px;
  box-shadow:0 6px 18px var(--shadow);
  flex:1 1 420px;
  max-width:480px;
  transition:transform 0.2s ease, box-shadow 0.2s ease;
}
.card:hover {transform:translateY(-4px); box-shadow:0 10px 24px var(--shadow);}
h2,h3,h4 {margin-top:0;margin-bottom:10px;}
label {display:block;font-size:12px;color:var(--text-muted);margin-bottom:6px;}
input,select,textarea,button {
  width:100%;
  padding:10px;
  border-radius:8px;
  border:none;
  background:var(--glass);
  color:var(--text);
  margin-bottom:10px;
  font-size:14px;
  transition:all 0.2s ease;
}
input:focus {outline:none; background:rgba(255,255,255,0.06);}
button.primary {
  background:linear-gradient(90deg,var(--accent),var(--accent-light));
  color:#0b0f1a;
  font-weight:600;
  cursor:pointer;
}
button.primary:hover {filter:brightness(1.1);}
.row {display:flex;gap:10px;}
.row > * {flex:1;}
.list {max-height:280px;overflow:auto;padding:10px;background:rgba(255,255,255,0.02);border-radius:8px;}
.item {display:flex;justify-content:space-between;align-items:center;padding:8px;border-bottom:1px solid rgba(255,255,255,0.05);}
.tag {font-size:12px;color:var(--text-muted);}
.success {color:var(--success);}
.danger {color:var(--danger);}
footer {text-align:center;color:var(--text-muted);font-size:12px;padding:20px;}
.notification {
  position:fixed;
  top:20px;
  right:20px;
  padding:12px 18px;
  border-radius:8px;
  color:#0b0f1a;
  font-weight:600;
  z-index:9999;
  opacity:0;
  transform:translateY(-10px);
  transition:all 0.3s ease;
}
.notification.show {opacity:1; transform:translateY(0);}
.notification.success {background:var(--success);}
.notification.danger {background:var(--danger);}
@media(max-width:980px){
  .wrap{flex-direction:column;align-items:center;}
  #admin_panel {display:none;}
  #admin_panel.show {display:block;}
}
</style>
</head>
<body>
<header>
  <h1><img src="https://via.placeholder.com/40?text=SDJ" alt="SDJ Logo"> SDJ Licensing System</h1>
  <div class="lead">Professional live frontend</div>
</header>
<div class="wrap">
<section class="card">
  <h2>Activate / Verify License</h2>
  <label>License Key</label>
  <input id="lic_input" placeholder="XXXX-XXXX-XXXX-XXXX">
  <label>Roblox Username</label>
  <input id="user_input" placeholder="PlayerName">
  <label>Game ID (Optional)</label>
  <input id="gameid_input" placeholder="123456789">
  <div class="row">
    <button class="primary" onclick="verifyLicense()">Verify / Activate</button>
  </div>
</section>
<section class="card">
  <h3>Admin Panel</h3>
  <label>Username</label>
  <input id="admin_user" value="admin">
  <label>Password</label>
  <input id="admin_pass" value="admin" type="password">
  <div class="row">
    <button onclick="adminLogin()">Login</button>
    <button onclick="logoutAdmin()">Logout</button>
  </div>
  <div id="admin_msg" class="tag"></div>
  <div id="admin_panel" style="display:none;">
    <h4>Generate Licenses</h4>
    <label>Prefix</label>
    <input id="gen_prefix" placeholder="PROMO">
    <div class="row">
      <input id="gen_count" value="1">
      <input id="gen_uses" value="1">
      <input id="gen_days" value="0">
    </div>
    <div class="row" style="margin-top:5px;">
      <button class="primary" onclick="generateLicenses()">Generate</button>
      <button onclick="exportData()">Export</button>
    </div>
    <h4>Active Licenses</h4>
    <div id="licenses_list" class="list"></div>
    <h4>Activations</h4>
    <div id="activations_list" class="list"></div>
  </div>
</section>
</div>
<footer>SDJ Licensing System â€” Live Backend Demo</footer>
<div id="notification" class="notification"></div>
<script>
const API_BASE="https://api.render.com/deploy/srv-d43t039r0fns73fgie8g?key=_0gJn5RJNZs";
const $=id=>document.getElementById(id);
let adminToken=null;

function showNotification(msg,type='success'){
  const n=$('notification');
  n.innerText=msg;
  n.className='notification show '+type;
  setTimeout(()=>{n.className='notification';},3000);
}

// Admin Login
function adminLogin(){
  const u=$('admin_user').value.trim();
  const p=$('admin_pass').value;
  if(u==="admin" && p==="admin"){ // simple demo auth
    adminToken='prod';
    $('admin_panel').style.display='block';
    showNotification('Admin logged in','success');
    refreshAdminViews();
  }else showNotification('Invalid credentials','danger');
}
function logoutAdmin(){adminToken=null;$('admin_panel').style.display='none'; showNotification('Admin logged out','danger');}

// Verify License
async function verifyLicense(){
  const license=$('lic_input').value.trim();
  const username=$('user_input').value.trim();
  const gameId=$('gameid_input').value.trim();
  if(!license||!username){showNotification('License & username required','danger');return;}
  try{
    const res=await fetch(`${API_BASE}/api/verify`,{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({license,username,gameId})
    });
    const data=await res.json();
    showNotification(data.message,data.valid?'success':'danger');
    refreshAdminViews();
  }catch(e){showNotification('Server error','danger');}
}

// Generate Licenses
async function generateLicenses(){
  if(!adminToken){showNotification('Login first','danger'); return;}
  const prefix=$('gen_prefix').value.trim();
  const count=Math.max(1,parseInt($('gen_count').value||1));
  const maxUses=Math.max(1,parseInt($('gen_uses').value||1));
  const days=Math.max(0,parseInt($('gen_days').value||0));
  try{
    const res=await fetch(`${API_BASE}/api/licenses`,{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({prefix,maxUses,expiresInDays:days})
    });
    const data=await res.json();
    showNotification(`License generated: ${data.key}`,'success');
    refreshAdminViews();
  }catch(e){showNotification('Error generating license','danger');}
}

// Refresh Admin Views
async function refreshAdminViews(){
  if(!adminToken) return;
  try{
    const licensesRes=await fetch(`${API_BASE}/api/licenses`);
    const licenses=await licensesRes.json();
    const licEl=$('licenses_list'); licEl.innerHTML='';
    licenses.forEach(l=>{
      const d=document.createElement('div'); d.className='item';
      d.innerHTML=`<div><strong>${l.key}</strong></div><div class="tag">uses ${l.uses}/${l.maxUses} - ${l.revoked?'<span class="danger">revoked</span>':'<span class="success">active</span>'}</div>`;
      licEl.appendChild(d);
    });
    const actRes=await fetch(`${API_BASE}/api/activations`);
    const acts=await actRes.json();
    const actEl=$('activations_list'); actEl.innerHTML='';
    acts.forEach(a=>{
      const d=document.createElement('div'); d.className='item';
      d.innerHTML=`<div><strong>${a.username}</strong> - <span class="tag">${a.licenseKey}</span></div><div class="tag">${new Date(a.time).toLocaleString()}</div>`;
      actEl.appendChild(d);
    });
  }catch(e){console.log(e);}
}

// Export Data
function exportData(){
  window.open(`${API_BASE}/api/licenses`,'_blank');
  showNotification('Export licenses opened','success');
}
</script>
</body>
</html>
